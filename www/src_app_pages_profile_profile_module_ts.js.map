{"version":3,"file":"src_app_pages_profile_profile_module_ts.js","mappings":"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","sources":["./src/app/pages/profile/profile-routing.module.ts","./src/app/pages/profile/profile.module.ts","./src/app/pages/profile/profile.page.ts","./src/app/pages/profile/profile.page.html"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ProfilePage } from './profile.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ProfilePage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ProfilePageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\nimport { ReactiveFormsModule } from '@angular/forms';\n\n\nimport { ProfilePageRoutingModule } from './profile-routing.module';\n\nimport { ProfilePage } from './profile.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ReactiveFormsModule,\n    ProfilePageRoutingModule\n  ],\n  declarations: [ProfilePage]\n})\nexport class ProfilePageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { Auth, updateProfile } from '@angular/fire/auth';\nimport { Router } from '@angular/router';\nimport { Camera, CameraResultType, CameraSource, Photo } from '@capacitor/camera';\nimport { LoadingController, AlertController, ActionSheetController } from '@ionic/angular';\nimport { AuthService } from 'src/app/services/auth.service';\nimport { AvatarService } from 'src/app/services/avatar.service';\nimport { doc } from '@angular/fire/firestore';\nimport { FormBuilder, FormGroup } from '@angular/forms';\n\n@Component({\n  selector: 'app-profile',\n  templateUrl: './profile.page.html',\n  styleUrls: ['./profile.page.scss'],\n})\nexport class ProfilePage implements OnInit {\n\n  profileForm: FormGroup;\n  user: import(\"@angular/fire/auth\").User;\n\n  constructor(\n    public avatarService: AvatarService,\n    private authService: AuthService,\n    private router: Router,\n    private loadingController: LoadingController,\n    private alertController: AlertController,\n    private auth: Auth,\n    private actionSheetController: ActionSheetController,\n    private fb: FormBuilder\n  ) {\n    this.auth.onAuthStateChanged(async (user) => {\n      if (user) {\n        this.user = user;\n        this.profileForm.patchValue({\n          displayName: user.displayName || '',\n        });\n        this.avatarService.profile = user; // Ensure the profile is set\n      }\n    });\n  }\n\n  ngOnInit() {\n    this.profileForm = this.fb.group({\n      displayName: ['']\n    });\n\n    this.profileForm.get('displayName').valueChanges.subscribe(value => {\n      this.saveProfile();\n    });\n  }\n\n  async logout() {\n    await this.authService.logout();\n    this.router.navigateByUrl('/', { replaceUrl: true });\n  }\n\n  goBack() {\n    // Use the router to navigate back\n    this.router.navigate(['/home']); // Replace '/previous-page' with your desired route\n  }\n\n  async presentImageSourceActionSheet() {\n    const actionSheet = await this.actionSheetController.create({\n      header: 'Select Image Source',\n      buttons: [\n        {\n          text: 'Camera',\n          icon: 'camera',\n          handler: () => {\n            this.changeImage(CameraSource.Camera);\n          }\n        },\n        {\n          text: 'Gallery',\n          icon: 'images',\n          handler: () => {\n            this.changeImage(CameraSource.Photos);\n          }\n        },\n        {\n          text: 'File',\n          icon: 'document',\n          handler: () => {\n            this.selectFile();\n          }\n        },\n        {\n          text: 'Cancel',\n          icon: 'close',\n          role: 'cancel'\n        }\n      ]\n    });\n    await actionSheet.present();\n  }\n\n  async changeImage(source: CameraSource) {\n    try {\n      const image = await Camera.getPhoto({\n        quality: 90,\n        allowEditing: false,\n        resultType: CameraResultType.Base64,\n        source: source,\n      });\n\n      if (image) {\n        const loading = await this.loadingController.create();\n        await loading.present();\n\n        if (!this.avatarService.profile?.uid) {\n          loading.dismiss();\n          const alert = await this.alertController.create({\n            header: 'Upload failed',\n            message: 'Profile UID is missing.',\n            buttons: ['OK'],\n          });\n          await alert.present();\n          return;\n        }\n\n        const result = await this.avatarService.uploadImage(image, this.avatarService.profile.uid);\n        loading.dismiss();\n\n        if (!result) {\n          const alert = await this.alertController.create({\n            header: 'Upload failed',\n            message: 'There was a problem uploading your avatar.',\n            buttons: ['OK'],\n          });\n          await alert.present();\n        } else {\n          const alert = await this.alertController.create({\n            header: 'Upload Successful',\n            message: 'Your avatar has been successfully uploaded.',\n            buttons: ['OK'],\n          });\n          await alert.present();\n\n          // Update the user profile\n          if (this.auth.currentUser) {\n            const result = await this.avatarService.uploadImage(image as Photo, this.avatarService.profile.uid);\n            await updateProfile(this.user, {\n              photoURL: result,\n            });\n            this.user = this.auth.currentUser; // Refresh the user object\n          }\n        }\n      }\n    } catch (error) {\n      const alert = await this.alertController.create({\n        header: 'Upload failed',\n        message: `There was a problem uploading your avatar: ${error.message}`,\n        buttons: ['OK'],\n      });\n      await alert.present();\n    }\n  }\n\n  async selectFile() {\n    const input = document.createElement('input');\n    input.type = 'file';\n    input.accept = 'image/*';\n    input.onchange = async (event: any) => {\n      const file = event.target.files[0];\n      if (file) {\n        const reader = new FileReader();\n        reader.onload = async (e: any) => {\n          const image = {\n            base64String: e.target.result.split(',')[1]\n          };\n          const loading = await this.loadingController.create();\n          await loading.present();\n\n          if (!this.avatarService.profile?.uid) {\n            loading.dismiss();\n            const alert = await this.alertController.create({\n              header: 'Upload failed',\n              message: 'Profile UID is missing.',\n              buttons: ['OK'],\n            });\n            await alert.present();\n            return;\n          }\n\n          const result = await this.avatarService.uploadImage(image as Photo, this.avatarService.profile.uid);\n          loading.dismiss();\n\n          if (!result) {\n            const alert = await this.alertController.create({\n              header: 'Upload failed',\n              message: 'There was a problem uploading your avatar.',\n              buttons: ['OK'],\n            });\n            await alert.present();\n          } else {\n            const alert = await this.alertController.create({\n              header: 'Upload Successful',\n              message: 'Your avatar has been successfully uploaded.',\n              buttons: ['OK'],\n            });\n            await alert.present();\n\n            // Update the user profile\n            if (this.auth.currentUser) {\n              await updateProfile(this.user, {\n                photoURL: result,\n              });\n              this.user = this.auth.currentUser; // Refresh the user object\n            }\n          }\n        };\n        reader.readAsDataURL(file);\n      }\n    };\n    input.click();\n  }\n\n  async saveProfile() {\n    if (this.user) {\n      const userDocRef = doc(this.avatarService.firestore, `Riders/${this.user.uid}`);\n      //const loading = await this.loadingController.create();\n      //await loading.present();\n\n      try {\n        await updateProfile(this.user, {\n          displayName: this.profileForm.get('displayName').value,\n        });\n        //loading.dismiss();\n        // const alert = await this.alertController.create({\n        //   header: 'Profile Updated',\n        //   message: 'Your profile information has been updated.',\n        //   buttons: ['OK'],\n        // });\n        // await alert.present();\n      } catch (error) {\n        // loading.dismiss();\n        // const alert = await this.alertController.create({\n        //   header: 'Update Failed',\n        //   message: 'There was a problem updating your profile.',\n        //   buttons: ['OK'],\n        // });\n        // await alert.present();\n      }\n    }\n  }\n}\n","<ion-header class=\"ion-no-border\">\n  <ion-toolbar>\n    <ion-buttons slot=\"start\">\n      <ion-button color=\"primary\" (click)=\"goBack()\">\n        <ion-back-button></ion-back-button>\n      </ion-button>\n    </ion-buttons>\n    <ion-buttons slot=\"end\">\n      <ion-button (click)=\"logout()\">\n        <ion-icon slot=\"icon-only\" name=\"log-out\"></ion-icon>\n      </ion-button>\n    </ion-buttons>\n    <ion-title>My Profile</ion-title>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content class=\"ion-padding\">\n  <div class=\"preview\">\n    <ion-avatar (click)=\"presentImageSourceActionSheet()\">\n      <img *ngIf=\"user?.photoURL; else placeholder_avatar;\" [src]=\"user.photoURL\" />\n\n      <ng-template #placeholder_avatar>\n        <div class=\"fallback\">\n          <p>Select avatar</p>\n        </div>\n      </ng-template>\n    </ion-avatar>\n  </div>\n\n  <form [formGroup]=\"profileForm\">\n    <ion-item class=\"ion-margin\">\n      <ion-icon name=\"call\" color=\"primary\" slot=\"start\"></ion-icon>\n      <ion-label>\n        {{ user?.phoneNumber }}\n      </ion-label>\n    </ion-item>\n\n    <ion-item class=\"ion-margin\">\n      <ion-icon name=\"person\" color=\"primary\" slot=\"start\"></ion-icon>\n      <ion-input formControlName=\"displayName\" placeholder=\"Name\"></ion-input>\n    </ion-item>\n\n    <ion-item class=\"ion-margin\">\n      <ion-icon name=\"mail\" color=\"primary\" slot=\"start\"></ion-icon>\n      <ion-label>\n        {{ user?.email }}\n      </ion-label>\n    </ion-item>\n  </form>\n\n  <ion-label color=\"primary\" class=\"ion-text-center ion-padding-top\">\n    <p>Ride receipts will be sent to your email.</p>\n  </ion-label>\n</ion-content>\n"],"names":["updateProfile","Camera","CameraResultType","CameraSource","doc","i0","ɵɵelement","ɵɵproperty","ctx_r0","user","photoURL","ɵɵsanitizeUrl","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ProfilePage","constructor","avatarService","authService","router","loadingController","alertController","auth","actionSheetController","fb","_this","onAuthStateChanged","_ref","_asyncToGenerator","profileForm","patchValue","displayName","profile","_x","apply","arguments","ngOnInit","group","get","valueChanges","subscribe","value","saveProfile","logout","_this2","navigateByUrl","replaceUrl","goBack","navigate","presentImageSourceActionSheet","_this3","actionSheet","create","header","buttons","text","icon","handler","changeImage","Photos","selectFile","role","present","source","_this4","image","getPhoto","quality","allowEditing","resultType","Base64","loading","uid","dismiss","alert","message","result","uploadImage","currentUser","error","_this5","input","document","createElement","type","accept","onchange","_ref2","event","file","target","files","reader","FileReader","onload","_ref3","e","base64String","split","_x3","readAsDataURL","_x2","click","_this6","userDocRef","firestore","ɵɵdirectiveInject","i1","AvatarService","i2","AuthService","i3","Router","i4","LoadingController","AlertController","i5","Auth","ActionSheetController","i6","FormBuilder","selectors","decls","vars","consts","template","ProfilePage_Template","rf","ctx","ɵɵlistener","ProfilePage_Template_ion_button_click_3_listener","ProfilePage_Template_ion_button_click_6_listener","ProfilePage_Template_ion_avatar_click_12_listener","ɵɵtemplate","ProfilePage_img_13_Template","ProfilePage_ng_template_14_Template","ɵɵtemplateRefExtractor","ɵɵadvance","_r1","ɵɵtextInterpolate1","phoneNumber","email"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}